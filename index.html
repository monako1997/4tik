<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>4Tik Pro</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--bg:#0a0b12;--ink:#f3f6fb;--muted:#aab6c5;--line:#1d2433;--c1:#25F4EE;--c2:#FE2C55;}
    *{box-sizing:border-box;font-family:'Cairo',sans-serif}
    html{scroll-behavior:smooth;background-color:var(--bg);}
    body{
      margin:0;min-height:100vh;display:flex;flex-direction:column;align-items:center;
      background:
        radial-gradient(800px 400px at 15% -10%, rgba(37,244,238,.12), transparent 60%),
        radial-gradient(900px 500px at 110% -20%, rgba(254,44,85,.12), transparent 60%),
        linear-gradient(180deg,#080910 0%, #0a0b12 100%);
      color:var(--ink);
    }
    .topbar{
      position:sticky; top:0; width:100%;
      display:flex; justify-content:center; align-items:center;
      padding:14px 24px;
      backdrop-filter:saturate(140%) blur(6px);
      background:linear-gradient(180deg, rgba(10,11,18,.65), rgba(10,11,18,0));
      z-index:10;
    }
    .brand{
      font-weight:900; font-size:42px; letter-spacing:.6px; margin:0;
      background:linear-gradient(90deg,var(--c2),var(--c1),var(--c2));
      -webkit-background-clip:text; background-clip:text; color:transparent;
      text-shadow:0 0 18px rgba(37,244,238,.35),0 0 18px rgba(254,44,85,.25);
      background-size:200% auto; animation:shine 3s linear infinite;
    }
    @keyframes shine { to { background-position:-200% center; } }
    .animated-entry{opacity:0;transform:translateY(20px);animation:fadeInUp .6s ease-out forwards;}
    #main-card{animation-delay:.2s;} #how-to-card{animation-delay:.4s;} #developer-card{animation-delay:.8s;}
    @keyframes fadeInUp{to{opacity:1;transform:translateY(0)}}
    .wrap{width:min(900px,96vw); padding:20px 16px 120px;}
    .card + .card{margin-top:24px;}
    #main-card.card{
      background:#0f1320;border:1px solid var(--line);border-radius:16px;padding:22px;box-shadow:0 20px 60px rgba(0,0,0,.35);
    }
    #how-to-card.card, #developer-card.card{
      position:relative;background:linear-gradient(137deg,var(--c2) 0%,var(--c1) 100%);
      border-radius:18px;transition:.3s ease;filter:drop-shadow(0 0 15px rgba(37,244,238,.4));padding:2px;
    }
    #how-to-card.card:hover, #developer-card.card:hover{filter:drop-shadow(0 0 25px rgba(37,244,238,.7));}
    .card-inner-content{background-color:#0f1320;border-radius:16px;padding:22px;}
    .upload{
      position:relative;border-radius:16px;padding:28px;text-align:center;cursor:pointer;
      background:rgba(255,255,255,.02);border:2px dashed #314055;overflow:hidden;isolation:isolate;transition:opacity .3s ease;
    }
    .upload::before{
      content:"";position:absolute;inset:-2px;z-index:-1;border-radius:18px;
      background:conic-gradient(from 0deg,var(--c1),var(--c2),var(--c1));filter:blur(14px);opacity:.45;
    }
    .u-title{display:inline-block;font-weight:800;font-size:22px;text-transform:uppercase;
      background:linear-gradient(90deg,var(--c1),var(--c2));-webkit-background-clip:text;background-clip:text;color:transparent;}
    .hint{margin-top:6px;color:var(--muted);font-size:14px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:14px;min-height:80px;flex-direction:column;justify-content:center;}
    .bar-wrap{height:14px;background:#0a0f1a;border:1px solid var(--line);border-radius:999px;overflow:hidden}
    .bar{height:100%;width:0%;border-radius:999px;background:linear-gradient(90deg,var(--c2),var(--c1));transition:width .12s}
    .bar.running{animation:slide 1.1s linear infinite;background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.15) 50%,transparent 100%);width:40%}
    @keyframes slide{from{margin-inline-start:-40%} to{margin-inline-start:100%}}
    .status{font-size:14px;color:var(--muted)}
    .text-section{text-align:center;}
    .card-title{font-size:24px;font-weight:800;margin:0 0 16px;background:linear-gradient(90deg,var(--c1),var(--c2));-webkit-background-clip:text;background-clip:text;color:transparent;}
    .card-text{color:var(--muted);font-size:16px;line-height:1.8;max-width:600px;margin:0 auto 20px;}
    .how-to-section ol{display:inline-block;text-align:start;max-width:100%;margin-bottom:20px;padding-inline-start:24px;}
    .how-to-section li{margin-bottom:12px;color:var(--muted);line-height:1.7;}
    .footer{
      position:fixed;bottom:0;left:0;right:0;
      padding:12px 20px;text-align:center;color:var(--muted);font-size:16px;
      background:linear-gradient(180deg, rgba(10,11,18,0), rgba(10,11,18,.55));
      backdrop-filter:saturate(140%) blur(6px);
    }
    .heart{display:inline-block;animation:beat 1.2s infinite ease-in-out;color:#FE2C55;}
    @keyframes beat{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}
    .developer-avatar{
      width:120px;height:120px;border-radius:50%;object-fit:cover;margin:4px auto 20px;border:3px solid var(--c1);box-shadow:0 0 20px rgba(37,244,238,.5);
    }
    .tiktok-follow-btn{
      display:inline-block;padding:10px 28px;background-color:var(--c2);color:var(--ink);border-radius:4px;font-weight:700;font-size:16px;
      text-decoration:none;transition:background-color .2s ease, transform .2s ease;border:1px solid var(--c2);min-width:150px;text-align:center;
    }
    .tiktok-follow-btn:hover{background-color:#e41e45;border-color:#e41e45;transform:scale(1.03);}
  </style>
</head>
<body>

  <header class="topbar animated-entry">
    <h1 class="brand">4Tik Pro</h1>
  </header>

  <main class="wrap">
    <section id="main-card" class="card animated-entry">
      <div id="drop" class="upload">
        <input id="file" type="file" accept="video/*" hidden />
        <div class="u-title">رفع الفيديو</div>
        <div id="fileInfo" class="hint">اسحب وأفلت الفيديو هنا، أو انقر للاختيار</div>
      </div>
      <div class="row">
        <button class="button" id="process" disabled>
          <span class="text_button">معالجة</span>
        </button>
        <div id="status" class="status"></div>
      </div>
      <div class="bar-wrap" style="margin-top:12px">
        <div id="bar" class="bar"></div>
      </div>
    </section>

    <section id="how-to-card" class="card text-section how-to-section animated-entry">
      <div class="card-inner-content">
        <h2 class="card-title">طريقة الاستخدام</h2>
        <ol>
          <li>١) ارفعي فيديو حتى 100MB كحد أقصى.</li>
          <li>٢) اضغطي زر «معالجة» لتحسين الفيديو.</li>
          <li>٣) بعد الانتهاء سيبدأ تنزيل الفيديو تلقائيًا.</li>
          <li>٤) افتحي تيك توك وارفعي المقطع (اختياري).</li>
          <li>٥) يمكنك تعديل الخصوصية لاحقًا كما تشائين.</li>
        </ol>
        <p class="card-text">أتمنى أن تجدي الموقع سهل الاستخدام. دعمك يمنحني الحماس ❤️</p>
      </div>
    </section>
    
    <section id="developer-card" class="card text-section animated-entry">
      <div class="card-inner-content">
        <h2 class="card-title">عن المطوِّرة</h2>
        <img src="https://p16-sign-va.tiktokcdn.com/tos-maliva-avt-0068/36fb03fab8355da6669fd8cae7a7f798~tplv-tiktokx-cropcenter:100:100.jpeg" alt="حساب تيك توك" class="developer-avatar">
        <p class="card-text">تابعيني على تيك توك للمزيد من التحديثات!</p>
        <div class="row" style="margin-top: 16px; min-height: initial;">
          <a href="https://www.tiktok.com/@queen_iy" target="_blank" rel="noopener noreferrer" class="tiktok-follow-btn">
            متابعة
          </a>
        </div>
      </div>
    </section>
  </main>
  
  <footer class="footer">
    <p>Made by Manal <span class="heart">❤️</span></p>
  </footer>

  <script>
    const drop = document.getElementById('drop');
    const fileInput = document.getElementById('file');
    const info = document.getElementById('fileInfo');
    const processBtn = document.getElementById('process');
    const bar = document.getElementById('bar');
    const status = document.getElementById('status');
    const mb = n => (n/1024/1024).toFixed(2)+' MB';

    drop.addEventListener('click', () => fileInput.click());
    drop.addEventListener('dragover', e => e.preventDefault());
    drop.addEventListener('drop', e => {
      e.preventDefault();
      fileInput.files = e.dataTransfer.files;
      updateInfo();
    });

    function updateInfo(){
      const f = fileInput.files[0];
      status.textContent = '';
      if(!f){
        info.textContent = "اسحب وأفلت الفيديو هنا، أو انقر للاختيار";
        processBtn.disabled = true;
        return;
      }
      info.textContent = `الملف: ${f.name} — ${mb(f.size)}`;
      processBtn.disabled = false;
    }

    fileInput.addEventListener('change', updateInfo);

    processBtn.addEventListener('click', () => {
      const f = fileInput.files[0]; if(!f) return;
      status.textContent = "جاري الرفع…";
      bar.classList.remove('running'); bar.style.width='0%';
      processBtn.disabled = true;
      fileInput.disabled = true;
      drop.style.pointerEvents = 'none';
      drop.style.opacity = '0.5';

      const fd = new FormData(); fd.append('file', f);
      const xhr = new XMLHttpRequest();
      xhr.open('POST', '/process', true);
      xhr.responseType = 'blob';
      xhr.upload.onprogress = e => {
        if(e.lengthComputable){ bar.style.width = Math.round((e.loaded/e.total)*100) + '%'; }
      };
      xhr.onreadystatechange = () => {
        if (xhr.readyState === XMLHttpRequest.HEADERS_RECEIVED){
          status.textContent = "تحسين الفيديو…";
          bar.classList.add('running');
        }
      };
      xhr.onload = () => {
        bar.classList.remove('running');
        if (xhr.status === 200) {
          status.textContent = "اكتملت المعالجة — سيبدأ التحميل الآن";
          const blob = xhr.response, url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = 'output.mp4'; document.body.appendChild(a); a.click();
          URL.revokeObjectURL(url);
          a.remove();
        } else {
          status.textContent = "حدث خطأ، يرجى المحاولة مرة أخرى.";
          enableUpload();
        }
      };
      xhr.onerror = () => { 
        bar.classList.remove('running');
        status.textContent = "فشل الاتصال.";
        enableUpload(); 
      };
      xhr.send(fd);
    });

    function enableUpload() {
      drop.style.pointerEvents = 'auto';
      drop.style.opacity = '1';
      fileInput.disabled = false;
      fileInput.value = '';
      info.textContent = "اسحب وأفلت الفيديو هنا، أو انقر للاختيار";
      status.textContent = "";
      processBtn.disabled = true;
    }
  </script>

</body>
</html>